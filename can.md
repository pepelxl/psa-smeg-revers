# Информация о шинах can
Магнитола имеет две шины. Основная шина CAN INFO DIV 125kb/s fault tolerant. Вторая шина связывает исключительно smeg и дисплей.

## Сигналы передаваемые по шине info
### ID 0x260, источник BSI, длина зависит от прошивки bsi, частота 500мс  
Пакет вещает текущие значения пользовательской конфигурации автомобиля. Предпологается, что при многопользовательской настройке, пакет будет свой, для каждого ключа автомобиля.  
D0[7]  устанавливает активность меню настроек системы и языков. если флаг снят, то на smeg оба меню не активные.  
D0[6-2] язык  
&nbsp; 0b00000 французский  
&nbsp; 0b00001 английский  
&nbsp; 0b00010 немецкий  
&nbsp; 0b00011 испанский  
&nbsp; 0b00100 итальянский  
&nbsp; 0b00101 португальский  
&nbsp; 0b00110 нидерландский  
&nbsp; 0b01000 бразильский(португальский)  
&nbsp; 0b01001 польский  
&nbsp; 0b01100 турецкий  
&nbsp; 0b01110 русский  
&nbsp; 0b01111 чешский  
&nbsp; 0b10000 хорватский  
&nbsp; 0b10001 венгерский  
D0[1]-D1[7] пробег и расход топлива  
&nbsp; 0b000 - l/100km-km  
&nbsp; 0b111 - mpg-miles  
&nbsp; 0b010 - km/l-km  
D1[6] температура цельсий - фаренгейт  
D1[5-3] яркость мягкой подсветки салона(7 ступеней 0b000-0b110)  
D1[2] устанавливает активность меню настроек систем автомобиля. если флаг снят, то на smeg пункты "настройка систем автомобиля" и "настройка скоростных режимов" не активные.  
D1[1]-D1[0] текущее значение темы звукового оформления(зуммер в подрулевом переключателе). четыре варианта.  
D2[7] текущее значение "автоматический стояночный тормоз"  
D2[6] текущее значение "пду для двери водителя"  
D2[5] текущее значение "пду для дверей кабины"  
D2[4] текущее значение "отпирание только багажника"  
D2[3] текущее значение "встреча водителя"  
D2[2] текущее значение "адаптивное освещение"  
D2[1]  текущее значение "дневные светодиодные ходовые огни"  
D2[0] текущее значение "мягкая подсветка салона"  
D3[7] текущее значение "статус сопровождающее освещение"  
D3[6-5] текущее значение "время сопровождающего освещения"  
&nbsp; 0b00=15сек  
&nbsp; 0b01=30сек  
&nbsp; 0b10=60сек  
D3[4]  
D3[3] текущее значение "дистанционное включение световых приборов"  
D3[2-1] текущее значение "время дистанционного включения световых приборов"  
&nbsp; 0b00=15сек  
&nbsp; 0b01=30сек  
&nbsp; 0b10=60сек  
D3[0] текущее значение "автоматическое включение дальнего света"  
D4[7] текущее значение "помощь при парковке"  
D4[6] текущее значение "помощь при обгоне"  
D4[5] текущее значение "включение очистителя заднего стекла"  
D4[4] текущее значение "электропривод крышки багажника"  
D4[3]  
D4[2]  
D4[1]  
D4[0]  
D5[7] текущее значение "сигнал о риске столкновения"  
D5[6-5] текущее значение "дистанция риска столкновения"  
&nbsp; 0x01=близко  
&nbsp; 0x10=норма  
&nbsp; 0x11=далеко  
D5[4]  текущее значение "автоматическое экстренное торможение" или текущее значение чекбокса "автомотическое торможение" в меню "сигнал о риске столкновения"   
D5[3]  
D5[2] текущее значение "автоматический наклон заднего зеркала при движении задним ходом"  
D5[1]  
D5[0]  
D6[7]  
D6[6]  
D6[5]  
D6[4]  
D6[3]  
D6[2]  текущее значение "подсветка решотки радиатора"  
D6[1]  
D6[0]  


### ID 0x15B, источник ГУ, длина, видимо, подразумевается равной длинне ID 0x260, Начинает отсылаться при внесении изменений на дисплее ГУ с частотой 1000мс и до получения равного ответа от BSI ID 0x260.  
Пакет задаёт значения пользовательской конфигурации автомобиля.  
Значения битовых масок равны ID 0x260 за исключением двух битов:  
D0[7] если флаг установлен в 0, то биты D0[6] - D1[6] не учитываются.  
D1[2] если флаг установлен в 0, то биты D1[5] и до конца не учитываются.  
  
### ID 0x361, источник BSI, длина зависит от прошивки bsi, частота 500мс  
Пакет вещает доступные опции пользовательской конфигурации автомобиля.  
D0[7] меню "настройка систем автомобиля"  
D0[6]  
D0[5] дистанционное включение световых приборов  
D0[4] адаптивное освещение  
D0[3] помощь при обгоне  
D0[2] мягкая подсветка салона  
D0[1] автоматическое включение дальнего света  
D0[0] дневные светодиодные ходовые огни  
D1[7] помощь при парковке  
D1[6] включение очистителя заднего стекла  
D1[5] сопровождающее освещение  
D1[4] встреча водителя  
D1[3] электропривод крышки багажника  
D1[2] отпирание только багажника  
D1[1] пду для двери водителя  
D1[0] пду для дверей кабины  
D2[7]  
D2[6]  
D2[5]  
D2[4] автоматический стояночный тормоз  
D2[3]   
D2[2] автоматический наклон заднего зеркала при включении передачи заднего хода  
D2[1]  
D2[0]  
D3[7]  
D3[6] автоматическое экстренное торможение или сигнал о риске столновения с пунктом автоматическое торможение (отключается вместе с зажиганием)  
D3[5] сигнал о риске столновения (отключается вместе с зажиганием)  
D3[4] меню "настройка скоростных режимов"  
D3[3]  
D3[2]  
D3[1]  
D3[0]  
D4[7]  
D4[6]  
D4[5]  
D4[4] подсветка решотки радиатора  
D4[3]  
D4[2]  
D4[1]  
D4[0]  
D5[7]  
D5[6]  
D5[5]  
D5[4]  
D5[3]  
D5[2]  
D5[1]  
D5[0]  

### ID 0x228, источник BSI, длина зависит от прошивки bsi, частота 1000мс  
Пакет вещает текущее состояние круиз контроля  
D0[7]-D1[0] установленная скорость(0-260км/ч), по умолчанию FFFF. Например D0=0x13 D1=88 в десятичной системе= 5000 = будет отображать 50км/ч. Глядя на байты D5-D6, возможно старший бит имеет другое назначение.  
D2[7] LIMIT - выбранный режим  
D2[6] CRUISE - выбранный режим  
D2[5] бит установлен, когда скорость автомобиля превышает заданную пользователем скорость(например нажатие на педаль газа). На приборной панели предусмотрено моргание индикатора выставленной скорости  
D2[4] бит установлен, когда скорость автомобиля находится в режиме регулировки(текущая скорость = заданной пользователем). Идет поддержание заданной скорости для LIMIT/CRUISE  
D2[3] бит установлен, когда скорость автомобиля находится в заданном диапазоне регулировки(>=0км/ч и <заданной пользователем)    
D2[2] бит возникновения ошибки при попытке активирировать систему с некорректными диапазонами(сигнал моргания). Например, D2=0x74 возникает и поддерживается несколько секунд при попытке активировать cruise на не допустимой скорости. Потом D2=0x70 для предотвращения мигания выставленной скорости на приборной панели.  
D2[1]  
D2[0] бит установлен, когда идет изменение заданной скорости, например от кнопок +/- руля, но бит не устанавливается при изменении скорости после клавиши MEM  
D3[7]  
D3[6]  
D3[5]  
D3[4]  
D3[3]   
D3[2]  
D3[1]  
D3[0]  
D4[7] CRUISE - запрос на внесение скорости из памяти(например, кнопка MEM на руле). На SMEG появляется вкладка  с выбором 6 
 предустановленных скоростей для круз-контроля. Не путать с 5 предустановленными скоростями, которые хранятся в BSI.  
D4[6] LIMIT - запрос на внесение скорости из памяти(например, кнопка MEM на руле). На SMEG появляется вкладка  с выбором 6 
 предустановленных скоростей для ограничителя скорости. Не путать с 5 предустановленными скоростями, которые хранятся в BSI.  
D4[5]-D4[0] установленное расстояние в секундах до впереди идущего автомобиля при наличии активного радара. Например: 0x19 = 25dex = 2,5сек  
D5[7]  
D5[6]-D6[0] отрегулированная скорость системами активного круиз-контроля. По умолчанию 7FFF  
D7[7]  
D7[6]  
D7[5]  
D7[4] Предположительно, бит выставлен, когда НЕ происходит изменение задающей скорости от систем активного круиза(скорость мишени равна скорости транспортного средства). Когда бит выставлен вместе с ID 0x1E7 D0[1] на приборной панели меняется пиктограмма круиза на пиктограмму круиза "скорость отрегулированна"   
D7[3]  
D7[2]  
D7[1]  
D7[0]  
примеры:  
	FF FF 30 00 14 7F FF 00 зажигание включено(в любом положении выключателя)  
	FF FF 00 80 14 7F FF 00 двигатель работает, система выключена  
	FF FF 00 80 14 7F FF 90 двигатель работает, активный круиз отключен через меню(работает как обычный)  
	1F 40 48 80 14 17 0C 10 выставлена скорость 80км/ч, задана дистанция 2с, зафиксировано впереди идущее транспортное средство со скоростью 59км/ч, производится регулировка а/м к скорости 59км/ч.  

### ID 0x1E7, источник BSI, длина зависит от прошивки bsi, частота 200мс  
Пакет вещает текущие значения индикатора временного интервала  
D0[7] Предположительно, статус системы - отключено. (бит выставлен при заглушенном двигателе)  
D0[6] система активна (в обычном режиме  и limit). В режиме cruise бит отсутствует.  
D0[5] бит неисправности радара, см. примеры  
D0[4] бит отображения. При этом бите приборная панель отображает текущее состояние времени.  
D0[3] красный контур, моргающий восклицательный знак  
D0[2]  
D0[1] обнаружена мишень. (на дисплее отображается автомобиль) так же см. id 0x228 D7[4]  
D0[0]  
D2 время в секундах до мишени. по умолчанию 0xFE (0с - 9,9с)  
Примеры:  
40  00  FE  65  FF  00  00 система активна, препядствий нет  
42  00  0D  65  FF  00  00 система активна, обнаружена мишень через 1,3с, вывод на дисплей не происходит(например скорость ниже 40км/ч)  
52  00  11  65  FF  00  00 система активна, обнаружена мишень через 1,7с, выводится на дисплей  
60  00  FE  65  FF  00  00 сообщение - пониженная обзорность  
70  00  FE  65  FF  00  00 сообщение - идёт инициализация   

### ID 0x364, источник SMEG, длина 5, частота 1000мс  
Пакет вещает нажатие сенсорных кнопок управления климатом  
Пример: 00 00 1E 00 00 - ничего не нажато  
D0[7] клавиша тепмература слева плюс  
D0[6] клавиша температура слева минус  
D0[5] клавиша температура справа плюс  
D0[4] клавиша температура справа минус  
D0[3] клавиша вентилятор плюс  
D0[2] клавиша вентилятор минус  
D0[1]  
D1[0]  
D1[7]  
D1[6]  
D1[5] клавиша система чистого воздуха  
D1[4] клавиша mono  
D1[3]   
D1[2]  
D1[1] клавиша поток вниз  
D1[0] клавиша поток вперёд  
D2[7] клавиша поток вверх  
D2[6] клавиша рециркуляция  
D2[5]  
D2[4]  
D2[3] клавиша a/c  
D2[2] клавиша auto  
D2[1] клавиша интенсивность - мягкий  
D2[0] клавиша интенсивность - норма  
D3[7] клавиша интенсивность - быстро  
D3[6]  
D3[5] клавиша климат сзади (выкл)  
D3[4]  
D3[3]  
D3[2]  
D3[1]  
D3[0]  
